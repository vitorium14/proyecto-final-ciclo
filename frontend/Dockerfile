# Etapa 1: Construir la aplicaci칩n Angular
FROM node:14 AS builder
WORKDIR /app
# Copiamos los archivos de dependencias
COPY package.json package-lock.json angular.json ./
RUN npm install
# Copiamos el resto del c칩digo y compilamos la app
COPY . .
RUN npm run build --prod

# Etapa 2: Servir los archivos est치ticos con Nginx
FROM nginx:alpine
# Copiamos el resultado del build (ajusta "mi-app" por el nombre real del directorio de salida)
COPY --from=builder /app/dist/mi-app /usr/share/nginx/html
# Copiamos la configuraci칩n personalizada de Nginx (para manejar, por ejemplo, el proxy hacia el backend)
COPY ../nginx/default.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]